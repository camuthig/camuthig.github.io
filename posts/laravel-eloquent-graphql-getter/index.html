<!DOCTYPE html>
<html lang="en-us">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
		<title>
				GraphQL Getters with Laravel Eloquent &middot; Chris Muthig
		</title>
	
		
  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
		<link rel="stylesheet" href="/css/custom.css">
		<link rel="stylesheet" href="/css/syntax.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,400i,700">
		
		<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
	
		
		<link href="" rel="alternate" type="application/rss+xml" title="Chris Muthig" />
	</head>
	
    <body>
        <nav class="navbar">
	<ul class="main-nav">
		<li>
			<a class="nav-links" href="/">Posts</a>
		</li>
		<li>
			<a class="nav-links" href="/about">About</a>
		</li>

	</ul>
</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <span>Written by</span>
        Chris Muthig
        <br>
        <span>on&nbsp;</span><time datetime="2018-05-29 00:00:00 &#43;0000 UTC">May 29, 2018</time>
</div>
		<h1 class="post-title">GraphQL Getters with Laravel Eloquent</h1>

<div class="tags-container">

    <div class="tag">
        <a class="tag-link" href="https://camuthig.dev/tags/laravel">laravel</a>
    </div>

    <div class="tag">
        <a class="tag-link" href="https://camuthig.dev/tags/php">php</a>
    </div>

    <div class="tag">
        <a class="tag-link" href="https://camuthig.dev/tags/graphql">graphql</a>
    </div>

</div>



		

		<p>I recently began work on a proof-of-concept project I have been mentally shaping for some time now. In building this, I
chose to stick with Laravel as a framework to build off of, as it is something I am familiar with, but I wanted to serve
my application&rsquo;s API using GraphQL instead of normal Laravel resources. For the task, I chose the
<a href="https://github.com/Folkloreatelier/laravel-graphql">Laravel GraphQL</a> package, as I am already familiar with the underlying
GraphQL implementation. My data model is very simple, with only a few columns of data and one or two relationships, so I
chose to stick with the most simple features of Eloquent in my implementation as well. Altogether, the GraphQL package
and Eloquent have made the creation of the barebones project simple.</p>

<p>I ran into one issue along the way, however: snakecase. I traditionally prefer using <code>snake_case</code> naming conventions
when defining columns in my database. However, with GraphQL, I have found <code>camelCase</code> to be much more natural. The
delimma arose from the fact that Eloquent maps attribute names directly as they are in the database, and Laravel dropped
support for converting to camelcase a <a href="https://github.com/laravel/ideas/issues/41">couple of years ago</a>. In my opinion,
this decision was fine, and I believe it is the job of the API&rsquo;s presentation layer to decide this stylistic
formatting, rather than enforcing it at the model layer. To that end, I implemented a simple default resolve function to
handle transforming the data:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-php" data-lang="php"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-php" data-lang="php">// config/graphql.js

// All other configuration values

    /*
     * Overrides the default field resolver
     *
     * The given implementation supports finding the snake_case variable names as defined by the Laravel
     * Eloquent models.
     */
    &#39;defaultFieldResolver&#39; =&gt; function ($root, $args, $context, $info) {
        $property = \GraphQL\Executor\Executor::defaultFieldResolver($root, $args, $context, $info);

        if ($property === null) {
            $fieldName = snake_case($info-&gt;fieldName);

            if ($root instanceof \Illuminate\Database\Eloquent\Model
                <span class="err">&amp;&amp;</span> in_array($fieldName, array_keys($root-&gt;getAttributes()))) {
                $property = $root-&gt;$fieldName;
            }
        }

        return $property;
    },

// Remainder of the configuration</code></pre></td></tr></table>
</div>
</div>
<p>A more robust solution might be to use a library such as <a href="https://symfony.com/doc/current/components/property_access.html">Symfony
PropertyAccess</a> to support finding attributes in a
number of locations. This would have to be weighed against pulling in the additional dependency and  the extra logic, of
course.</p>

<p>It is important to also note that while this solution provides automatic mappings from <code>Eloquent name -&gt; GraphQL name</code>,
it does not provide the inverse, and in my mutation and query resolvers, I am explicitly taking the input variables and
mapping them to the snakecase names of my models as necessary.</p>


		
	</div>

	<div class="pagination">
		<a href="/posts/faktory-worker-client-php/" class="right arrow">&#8594;</a>

		<a href="#" class="top">Top</a>
	</div>
</main>


        		<footer>
			<span>
			&copy; <time datetime="2021-06-14 17:19:53.725005711 &#43;0000 UTC m=&#43;0.541448504">2021</time> Chris Muthig. Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
			</span>
		</footer>

    </body>
</html>
